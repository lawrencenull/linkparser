/*LinkParser Plugin v.0.2 (https://github.com/maparrar/linkparser)
 *Apr 2013
 * - Tony of Redsunsoft: http://www.redsunsoft.com/2011/01/parse-link-like-facebook-with-jquery-and-php/
 * - maparrar: maparrar (at) gmail (dot) com
 **/
;(function(e){function t(t,i){var s={urlDefault:"",withInput:true};var o=e.extend(s,i);t.addClass("linkparser");t.append(r(o.urlDefault));if(!o.withInput){n(t,o)}t.find(".lp_parse").click(function(e){e.preventDefault();n(t,o)})}function n(t,n){var r=t.find(".lp_url").val();if(!n.withInput){r=n.urlDefault}var s=t.find(".lp_loading");var o=t.find(".lp_url");var u=t.find(".lp_content");var a=t.find(".lp_info");var f=t.find(".lp_response_title");var l=t.find(".lp_response_description");var c=t.find(".lp_total_images_info");var h=t.find(".lp_response_total_images");var p=t.find(".lp_response_images");var d=t.find(".lp_cur_image");var v=t.find(".lp_cur_image_num");var m=t.find(".lp_prev");var g=t.find(".lp_next");if(!i(r)){system.message("Please enter a valid url.");return false}else{s.show();o.html(r);e.post(n.fetchScript,{url:escape(r)},function(t){f.text(t.title);l.text(t.description);h.text(t.total_images);if(t.total_images>0){p.empty();e.each(t.images,function(e,t){p.append('<img src="'+t.img+'" width="100" id="'+(e+1)+'">')});p.find("img").hide();p.find("img#1").fadeIn();d.val(1);v.html(1)}else{p.hide();a.width("100%");c.text("No images available")}u.fadeIn("slow");s.hide();m.click(function(e){e.preventDefault();var t=parseInt(h.text());if(t>0){var n=d.val();var r=0;p.find("img#"+n).hide();if(n>1){r=parseInt(n)-parseInt(1)}else{r=t}d.val(r);v.text(r);p.find("img#"+r).show()}});g.click(function(e){e.preventDefault();var t=parseInt(h.text());if(t>0){var n=d.val();var r=0;p.find("img#"+n).hide();if(n<t){r=parseInt(n)+parseInt(1)}else{r=1}d.val(r);v.text(r);p.find("img#"+r).show()}})})}}function r(e){var t="";if(e.withInput){t='<input class="lp_url" type="text" value="'+e.urlDefault+'">'+'<input class="lp_parse" type="button" value="Parse" />'}return'<div class="lp_link">'+t+'<input type="hidden" class="lp_cur_image" />'+"</div>"+'<div class="lp_loader">'+'<div class="lp_loading" align="center" id="atc_loading"></div>'+'<div class="lp_content">'+'<div class="lp_response_images"></div>'+'<div class="lp_info">'+'<div class="lp_response_title"></div>'+'<div class="lp_url"></div>'+'<div class="lp_response_description"></div>'+"</div>"+'<div class="lp_total_image_nav" >'+'<a class="lp_prev" href="#" id="prev"></a>'+'<a class="lp_next" href="#" id="next"></a>'+"</div>"+'<div class="lp_total_images_info" >'+'Showing <span class="lp_cur_image_num">0</span> of <span class="lp_response_total_images">0</span> images'+"</div>"+"</div>"+"</div>"}function i(e){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;if(t.test(e)){return true}else{return false}}e.fn.linkparser=function(n){switch(n){case"hideCutted":hideCutted(this);break;default:return this.each(function(){t(e(this),n)})}};})(jQuery);